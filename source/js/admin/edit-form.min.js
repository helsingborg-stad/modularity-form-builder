export default(function($){function EditForm(){$(function(){this.handleEvents()}.bind(this))}return EditForm.prototype.deleteFile=function(postId,formId,filePath,fieldName,target){$.ajax({url:ajaxurl,type:"post",data:{action:"delete_file",postId:postId,formId:formId,filePath:filePath,fieldName:fieldName},beforeSend:function(response){target.remove()},error:function(jqXHR,textStatus,errorThrown){console.log("Error: "+textStatus)}})},EditForm.prototype.uploadFile=function(files,postId,formId,fieldName,target){var data=new FormData;data.append("action","upload_files"),data.append("postId",postId),data.append("formId",formId),data.append("fieldName",fieldName),$.each(files,(function(key,value){data.append(fieldName+"[]",value)})),$.ajax({url:ajaxurl,type:"POST",data:data,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(response){$("input[type=file]",target).hide(),$(".upload-status",target).html('<div class="spinner spinner-dark is-active" style="float:none;"></div>')},success:function(response,textStatus,jqXHR){response.success&&$(":submit","#publishing-action,#edit-post").trigger("click"),$(".upload-status",target).html("<p>"+response.data+"</p>"),$("input[type=file]",target).show(),console.log(data)},error:function(jqXHR,textStatus){console.log("error: "+textStatus),$("input[type=file]",target).show(),$(".upload-status",target).hide()}})},EditForm.prototype.savePost=function(event){var $form=$(event.target),data=new FormData(event.target);return data.append("action","save_post"),$form.find('button[type="submit"]').attr("disabled","true").append('<span class="spinner"></span>'),$.ajax({url:ajaxurl,type:"POST",data:data,dataType:"json",processData:!1,contentType:!1,success:function(response){response.success?$form.find('button[type="submit"]').append('<i class="pricon pricon-check"></i>').find(".spinner").hide():$(".modal-footer",$form).html('<span class="notice warning"><i class="pricon pricon-notice-warning"></i> '+response.data+"</span>")},complete:function(){location.hash="",location.reload()}}),!1},EditForm.prototype.handleEvents=function(){$(document).on("submit","#edit-post",function(e){e.preventDefault(),this.savePost(e)}.bind(this)),$(document).on("click",".delete-form-file",function(e){if(e.preventDefault(),window.confirm(formbuilder.delete_confirm)){var postId=$(e.target).attr("postid"),formId=$(e.target).attr("formid"),filePath=$(e.target).attr("filepath"),fieldName=$(e.target).attr("fieldname"),$target=$(e.target).parents("span");this.deleteFile(postId,formId,filePath,fieldName,$target)}}.bind(this)),$(document).on("change","input[type=file]",function(e){var files=e.target.files,postId=$(e.target).attr("postid"),formId=$(e.target).attr("formid"),fieldName=$(e.target).attr("fieldname"),$target=$(e.target).parents(".mod-form-field");this.uploadFile(files,postId,formId,fieldName,$target)}.bind(this))},new EditForm}(jQuery));
//# sourceMappingURL=edit-form.min.js.map