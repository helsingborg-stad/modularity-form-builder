(()=>{var t={573:()=>{!function(t){var e=[];function n(){t(function(){this.init(),this.dataGathering(),this.updateMainSelect(),this.updateSubSelect(),t(document).on("click",'.post-type-mod-form input[type="checkbox"], .post-type-mod-form .acf-tab-button',function(t){this.dataGathering(),this.updateMainSelect(),this.updateSubSelect()}.bind(this)),t("[data-name='form_conditional_field'] .acf-input select").change(function(t){this.updateSubSelect()}.bind(this))}.bind(this))}n.prototype.init=function(){"undefined"!=typeof notificationConditions&&null!==notificationConditions&&(notificationConditions=JSON.parse(notificationConditions),["conditional_field","conditional_field_equals"].forEach(function(e){t("[data-name='notify'] .acf-row:not(.acf-clone)").each(function(n,a){if(null!==notificationConditions[n]){var o=t("[data-name='form_"+e+"'] .acf-input select",a);o.empty(),o.append(t("<option></option>").attr("value",notificationConditions[n][e]).text(notificationConditions[n][e]).attr("selected","selected"))}})}))},n.prototype.updateMainSelect=function(){t("[data-name='notify'] .acf-row:not(.acf-clone)").each(function(n,a){var o=t("[data-name='form_conditional_field'] .acf-input select",a),i=t(o).val();t(o).empty(),t.each(e,function(e,n){i==e?t(o).append(t("<option></option>").attr("value",e).text(e).attr("selected","selected")):t(o).append(t("<option></option>").attr("value",e).text(e))})}.bind(this))},n.prototype.updateSubSelect=function(){t("[data-name='notify'] .acf-row:not(.acf-clone)").each(function(n,a){var o=t("[data-name='form_conditional_field_equals'] .acf-input select",a),i=t("[data-name='form_conditional_field'] .acf-input select",a),c=t(o).val();t(i).val(),t(o).empty(),t.each(e,function(n,a){i.val()==n&&t.each(e[n],function(e,n){c==n?t(o).append(t("<option></option>").attr("value",n).text(n).attr("selected","selected")):t(o).append(t("<option></option>").attr("value",n).text(n))})})}.bind(this))},n.prototype.dataGathering=function(){e={},t("[data-name='form_fields'] .layout").each(function(n,a){var o=t(a).attr("data-layout"),i=t(".acf-fields  [data-name='label'] .acf-input .acf-input-wrap input",a).val();if(-1!=["select","radio"].indexOf(o)){var c=t("[data-name='required'] .acf-input label input",a).prop("checked"),l=t("[data-name='conditional_logic'] .acf-input label input",a).prop("checked");if(c&&!l){e[i]=[];var d=t("[data-name='values'] tbody [data-name='value'] .acf-input .acf-input-wrap input[type='text']",a);t(d).filter(function(e,n){return!t(n).attr("name").includes("acfclonefield")}).each(function(n,a){t(a).val()&&i&&e[i].push(t(a).val())}.bind(this))}}})},new n}(jQuery)}},e={};function n(a){var o=e[a];if(void 0!==o)return o.exports;var i=e[a]={exports:{}};return t[a](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t;t=jQuery,new function(){t(function(){formbuilder.mod_form_authorized||t('[data-name="upload_videos_external"]').hide()}.bind(this))},function(t){function e(){t(function(){this.handleEvents()}.bind(this))}e.prototype.deleteFile=function(e,n,a,o,i){t.ajax({url:ajaxurl,type:"post",data:{action:"delete_file",postId:e,formId:n,filePath:a,fieldName:o},beforeSend:function(t){i.remove()},error:function(t,e,n){console.log("Error: "+e)}})},e.prototype.uploadFile=function(e,n,a,o,i){var c=new FormData;c.append("action","upload_files"),c.append("postId",n),c.append("formId",a),c.append("fieldName",o),t.each(e,function(t,e){c.append(o+"[]",e)}),t.ajax({url:ajaxurl,type:"POST",data:c,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(e){t("input[type=file]",i).hide(),t(".upload-status",i).html('<div class="spinner spinner-dark is-active" style="float:none;"></div>')},success:function(e,n,a){e.success&&t(":submit","#publishing-action,#edit-post").trigger("click"),t(".upload-status",i).html("<p>"+e.data+"</p>"),t("input[type=file]",i).show()},error:function(e,n){console.log("error: "+n),t("input[type=file]",i).show(),t(".upload-status",i).hide()}})},e.prototype.savePost=function(e){var n=t(e.target),a=new FormData(e.target);return a.append("action","save_post"),n.find('button[type="submit"]').attr("disabled","true").append('<span class="spinner"></span>'),t.ajax({url:ajaxurl,type:"POST",data:a,dataType:"json",processData:!1,contentType:!1,success:function(e){e.success?n.find('button[type="submit"]').append('<i class="pricon pricon-check"></i>').find(".spinner").hide():t(".modal-footer",n).html('<span class="notice warning"><i class="pricon pricon-notice-warning"></i> '+e.data+"</span>")},complete:function(){location.hash="",location.reload()}}),!1},e.prototype.handleEvents=function(){t(document).on("submit","#edit-post",function(t){t.preventDefault(),this.savePost(t)}.bind(this)),t(document).on("click",".delete-form-file",function(e){if(e.preventDefault(),window.confirm(formbuilder.delete_confirm)){var n=t(e.target).attr("postid"),a=t(e.target).attr("formid"),o=t(e.target).attr("filepath"),i=t(e.target).attr("fieldname"),c=t(e.target).parents("span");this.deleteFile(n,a,o,i,c)}}.bind(this)),t(document).on("change","input[type=file]",function(e){var n=e.target.files,a=t(e.target).attr("postid"),o=t(e.target).attr("formid"),i=t(e.target).attr("fieldname"),c=t(e.target).parents(".mod-form-field");this.uploadFile(n,a,o,i,c)}.bind(this))},new e}(jQuery);var e=n(573),a=n.n(e);(function(t){function e(){t(document).ready(function(){this.populateSelectFields(),this.handleEvents(),this.handleAcfConditionals()}.bind(this))}e.prototype.handleAcfConditionals=()=>{"undefined"!=typeof acf&&document.querySelectorAll('.acf-field[data-name="form_fields"]').forEach(t=>{const n=document.querySelectorAll('[data-name="conditonal_field"]');console.log(n),n&&e.prototype.handleSelectedConditionalFields(n)})},e.prototype.handleSelectedConditionalFields=function(t){t.forEach(t=>{const e=t.querySelector("select"),n=t.querySelector('input[type="hidden"]');n&&n.value&&(e.value=n.value)})},e.prototype.populateSelectFields=function(){t('[data-name="conditonal_field"] select').each(function(e,n){var a="",o=t(":selected",n);if(o.val())a=o.val();else if("undefined"!=typeof modularity_current_post_id){var i=t(n).attr("name");t.ajax({url:ajaxurl,type:"post",data:{action:"get_selected_field",moduleId:modularity_current_post_id,fieldName:i},success:function(e){"error"!=e&&t("option[value='"+e+"']",n).prop("selected",!0)}})}t("optgroup, option",n).remove();var c=this.getOptions();void 0!==c&&c.length>0?(t(".condition-missing").remove(),t.each(c,function(e,o){var i="";t.each(o.selectvalues,function(t,e){var n={label:this.conditionalString(o.groupLabel),value:this.conditionalString(e)};i+="<option value='"+JSON.stringify(n)+"'>"+e+"</option>"}.bind(this));var c='<optgroup label="'+o.groupLabel+'">'+i+"</optgroup>";t(n).append(c),a&&t("option[value='"+a+"']",n).prop("selected",!0)}.bind(this))):(t(".condition-missing").remove(),t('<p class="condition-missing">'+formbuilder.selections_missing+"</p>").insertBefore(n))}.bind(this))},e.prototype.getOptions=function(e){var n=[];return t('[data-layout="radio"]:not(.acf-clone)').each(function(e,a){var o={groupLabel:t(a).find('[data-name="label"] input').val(),selectvalues:[]};t('[data-key="field_58eb670d39fef"] table tbody',a).children("tr.acf-row:not(.acf-clone)").each(function(e,n){var a=t(n).find('[data-name="value"] input').val();o.selectvalues.push(a)}),n.push(o)}),n},e.prototype.conditionalString=function(t){return(t=(t=(t=t.toLowerCase()).replace(/\s+/g,"_")).replace(/[^a-z0-9_]+/gi,"")).replace(/_+$/,"")},e.prototype.handleEvents=function(){t(document).on("click",'[data-name="conditional_logic"] [type="checkbox"], [data-layout="radio"] .acf-row-handle > a',function(){this.populateSelectFields()}.bind(this))},new e})(jQuery),a()})()})();
//# sourceMappingURL=modularity-form-builder-admin.6b4a7137.js.map